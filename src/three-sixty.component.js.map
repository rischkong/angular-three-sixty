{"version":3,"file":"three-sixty.component.js","sourceRoot":"","sources":["three-sixty.component.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n    Component,\n    ElementRef,\n    ViewChild,\n    Input,\n    OnInit,\n    Output,\n    EventEmitter,\n    ViewEncapsulation,\n    OnChanges,\n    SimpleChanges\n} from '@angular/core';\nimport { ThreeSixtyFactory } from './three-sixty.factory';\nimport { HotspotInterface } from '@mediaman/three-sixty/dist/interfaces/hotspot.interface';\nimport { ConfigurationInterface } from '@mediaman/three-sixty/dist/interfaces/configuration.interface';\nimport { ImageSetInterface } from '@mediaman/three-sixty/dist/interfaces/image-set.interface';\nimport ThreeSixty from '@mediaman/three-sixty';\n\n@Component({\n    selector: 'mm-three-sixty',\n    styleUrls: ['../node_modules/@mediaman/three-sixty/dist/three-sixty.css'],\n    template: `<canvas #canvasElement class=\"mm-three-sixty\" [width]=\"width\" [height]=\"height\"></canvas>`,\n    encapsulation: ViewEncapsulation.None\n})\nexport class ThreeSixtyComponent implements OnInit, OnChanges {\n\n    /**\n     * The canvas width\n     */\n    @Input() public width: number;\n\n    /**\n     * The canvas height\n     */\n    @Input() public height: number;\n\n    /**\n     * Total amount of angles\n     */\n    @Input() public angles: number;\n\n    /**\n     * Amount of angles per image\n     */\n    @Input() public anglesPerImage: number;\n\n    /**\n     * The initial angle to show (number between 0 and 360)\n     */\n    @Input() public startAngle: number = 0;\n\n    /**\n     * Image set with all (ordered) image urls\n     */\n    @Input() public images: ImageSetInterface = {};\n\n    /**\n     * The factor which increases the drag speed\n     * Default to 5\n     */\n    @Input() public speedFactor: number;\n\n    /**\n     * Array of hotspots\n     */\n    @Input() public hotspots: HotspotInterface[];\n\n    /**\n     * Flag to control if all images should be preloaded\n     */\n    @Input() public preload: boolean = false;\n\n    /**\n     * Gets emitted when the images were preloaded\n     */\n    @Output() public preloaded: EventEmitter<null> = new EventEmitter();\n\n    /**\n     * The canvas element reference\n     */\n    @ViewChild('canvasElement') private canvasElement: ElementRef;\n\n    /**\n     * The three sixty instance\n     */\n    private threeSixty: ThreeSixty;\n\n    /**\n     * @param threeSixtyFactory\n     */\n    public constructor(private threeSixtyFactory: ThreeSixtyFactory) {\n    }\n\n    /**\n     * @inheritDoc\n     */\n    public ngOnInit() {\n        this.threeSixty = this.threeSixtyFactory.create(this.canvasElement.nativeElement, this.getThreeSixtyConfiguration());\n\n        this.threeSixty.initialize(this.images, this.startAngle);\n\n        this.preloadImages();\n    }\n\n    /**\n     * @inheritDoc\n     */\n    public ngOnChanges(changes: SimpleChanges) {\n        if (!this.threeSixty) {\n            return;\n        }\n\n        // Don't update the configuration if only the images have been changed\n        const changedProperties = Object.keys(changes);\n        if (changedProperties.length > 1 || !changes.hasOwnProperty('images')) {\n            this.threeSixty.updateConfiguration(this.getThreeSixtyConfiguration());\n        }\n\n        if (changes.hasOwnProperty('images')) {\n            this.threeSixty.updateImages(this.images);\n            this.preloadImages();\n        }\n    }\n\n    /**\n     * Force a preload of all images\n     */\n    public forcePreload() {\n        this.threeSixty.preload().then(() => this.preloaded.emit());\n    }\n\n    /**\n     * Preload all images if the preload flag is set\n     */\n    private preloadImages() {\n        if (this.preload) {\n            this.threeSixty.preload().then(() => this.preloaded.emit());\n        }\n    }\n\n    /**\n     * Get the configuration object for the ThreeSixty instance\n     */\n    private getThreeSixtyConfiguration(): ConfigurationInterface {\n        const configuration: ConfigurationInterface = {\n            angles: this.angles,\n            anglesPerImage: this.anglesPerImage\n        };\n\n        if (this.speedFactor >= 0) {\n            configuration.speedFactor = this.speedFactor;\n        }\n\n        if (this.hotspots) {\n            configuration.hotspots = this.hotspots;\n        }\n        return configuration;\n    }\n}\n"]}